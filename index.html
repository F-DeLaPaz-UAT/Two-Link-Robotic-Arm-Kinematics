<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Two-Link Arm Kinematics Demo</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #2d3748;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
            flex-wrap: wrap;
        }
        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            color: #718096;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 600;
        }
        .tab:hover {
            color: #4c51bf;
        }
        .tab.active {
            color: #4c51bf;
            border-bottom-color: #4c51bf;
        }
        .content-section {
            margin-top: 20px;
        }
        .canvas-container {
            background: #f7fafc;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #e2e8f0;
        }
        canvas {
            display: block;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .control-group {
            background: #f7fafc;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }
        .control-group label {
            display: block;
            margin-bottom: 8px;
            color: #2d3748;
            font-weight: 600;
        }
        input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }
        .value-display {
            text-align: center;
            color: #4c51bf;
            font-weight: bold;
            font-size: 1.1em;
        }
        .info-box {
            background: #ebf8ff;
            border-left: 4px solid #4299e1;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .info-box.warning {
            background: #fff5f5;
            border-left-color: #f56565;
        }
        .info-box h3 {
            margin-top: 0;
            color: #2c5282;
        }
        .info-box.warning h3 {
            color: #c53030;
        }
        .parameter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .parameter-card {
            background: white;
            border: 2px solid #4299e1;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        .parameter-card h4 {
            margin: 0 0 10px 0;
            color: #2c5282;
            font-size: 1.3em;
        }
        .parameter-card p {
            margin: 5px 0;
            color: #4a5568;
        }
        .flowchart {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .flow-node {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px auto;
            max-width: 400px;
            text-align: center;
            font-weight: 600;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .flow-arrow {
            text-align: center;
            font-size: 24px;
            color: #4c51bf;
            margin: 5px 0;
        }
        .elbow-demo {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        @media (max-width: 768px) {
            .elbow-demo {
                grid-template-columns: 1fr;
            }
        }
        .elbow-card {
            background: #f7fafc;
            border-radius: 8px;
            padding: 20px;
            border: 2px solid #e2e8f0;
        }
        .elbow-card h3 {
            margin-top: 0;
            color: #2d3748;
            text-align: center;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .equation {
            background: #2d3748;
            color: #48bb78;
            padding: 10px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
        }
        .config-indicator {
            margin-top: 10px;
            padding: 10px;
            background: #edf2f7;
            border-radius: 6px;
            text-align: center;
            font-size: 14px;
            font-weight: bold;
        }
        .config-up {
            background: #c6f6d5;
            color: #22543d;
        }
        .config-down {
            background: #fed7d7;
            color: #742a2a;
        }
        .config-boundary {
            background: #fef5e7;
            color: #975a16;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function TwoLinkArmDemo() {
            const [activeTab, setActiveTab] = useState('parameters');
            const [l1, setL1] = useState(150);
            const [l2, setL2] = useState(120);
            const [theta1, setTheta1] = useState(45);
            const [theta2, setTheta2] = useState(60);
            const [elbowConfig, setElbowConfig] = useState('up');
            const [targetX, setTargetX] = useState(200);
            const [targetY, setTargetY] = useState(100);
            const canvasRef = useRef(null);

            useEffect(() => {
                drawArm();
            }, [l1, l2, theta1, theta2, activeTab, elbowConfig, targetX, targetY]);

            const getElbowConfiguration = (theta2Val) => {
                const absTheta2 = Math.abs(theta2Val);
                if (absTheta2 < 90) return 'up';
                if (absTheta2 > 90) return 'down';
                return 'boundary';
            };

            const drawArm = () => {
                const canvas = canvasRef.current;
                if (!canvas) return;
                const ctx = canvas.getContext('2d');
                const width = canvas.width;
                const height = canvas.height;

                ctx.clearRect(0, 0, width, height);

                // Origin point (shoulder)
                const originX = width / 2;
                const originY = height - 100;

                if (activeTab === 'parameters' || activeTab === 'elbow') {
                    // Convert angles to radians
                    const theta1Rad = (theta1 * Math.PI) / 180;
                    const theta2Rad = (theta2 * Math.PI) / 180;

                    // Calculate joint positions
                    const elbowX = originX + l1 * Math.cos(theta1Rad);
                    const elbowY = originY - l1 * Math.sin(theta1Rad);

                    const endX = elbowX + l2 * Math.cos(theta1Rad + theta2Rad);
                    const endY = elbowY - l2 * Math.sin(theta1Rad + theta2Rad);

                    // Draw ground line
                    ctx.strokeStyle = '#a0aec0';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(0, originY);
                    ctx.lineTo(width, originY);
                    ctx.stroke();

                    // Draw reference line from shoulder to end effector (dashed)
                    ctx.strokeStyle = '#cbd5e0';
                    ctx.lineWidth = 2;
                    ctx.setLineDash([5, 5]);
                    ctx.beginPath();
                    ctx.moveTo(originX, originY);
                    ctx.lineTo(endX, endY);
                    ctx.stroke();
                    ctx.setLineDash([]);

                    // Draw link 1
                    ctx.strokeStyle = '#4299e1';
                    ctx.lineWidth = 8;
                    ctx.beginPath();
                    ctx.moveTo(originX, originY);
                    ctx.lineTo(elbowX, elbowY);
                    ctx.stroke();

                    // Draw link 2
                    ctx.strokeStyle = '#48bb78';
                    ctx.lineWidth = 8;
                    ctx.beginPath();
                    ctx.moveTo(elbowX, elbowY);
                    ctx.lineTo(endX, endY);
                    ctx.stroke();

                    // Draw joints
                    ctx.fillStyle = '#2d3748';
                    ctx.beginPath();
                    ctx.arc(originX, originY, 12, 0, 2 * Math.PI);
                    ctx.fill();

                    ctx.fillStyle = '#e53e3e';
                    ctx.beginPath();
                    ctx.arc(elbowX, elbowY, 10, 0, 2 * Math.PI);
                    ctx.fill();

                    ctx.fillStyle = '#ed8936';
                    ctx.beginPath();
                    ctx.arc(endX, endY, 10, 0, 2 * Math.PI);
                    ctx.fill();

                    // Draw angle arcs
                    ctx.strokeStyle = '#805ad5';
                    ctx.lineWidth = 2;
                    ctx.setLineDash([5, 5]);
                    
                    // Theta1 arc
                    ctx.beginPath();
                    ctx.arc(originX, originY, 40, -theta1Rad, 0, theta1Rad < 0);
                    ctx.stroke();

                    // Theta2 arc at elbow
                    const elbowBaseAngle = theta1Rad;
                    ctx.beginPath();
                    ctx.arc(elbowX, elbowY, 30, elbowBaseAngle, elbowBaseAngle + theta2Rad, theta2Rad < 0);
                    ctx.stroke();

                    ctx.setLineDash([]);

                    // Draw labels
                    ctx.fillStyle = '#2d3748';
                    ctx.font = 'bold 16px Arial';
                    
                    // l1 label
                    const l1MidX = originX + (l1/2) * Math.cos(theta1Rad);
                    const l1MidY = originY - (l1/2) * Math.sin(theta1Rad);
                    ctx.fillText('l‚ÇÅ', l1MidX - 20, l1MidY - 10);

                    // l2 label
                    const l2MidX = elbowX + (l2/2) * Math.cos(theta1Rad + theta2Rad);
                    const l2MidY = elbowY - (l2/2) * Math.sin(theta1Rad + theta2Rad);
                    ctx.fillText('l‚ÇÇ', l2MidX - 20, l2MidY - 10);

                    // Theta labels
                    ctx.fillStyle = '#805ad5';
                    ctx.fillText('Œ∏‚ÇÅ', originX + 50, originY - 20);
                    ctx.fillText('Œ∏‚ÇÇ', elbowX + 40, elbowY - 15);

                    // Joint labels
                    ctx.fillStyle = '#2d3748';
                    ctx.fillText('Shoulder', originX - 35, originY + 30);
                    ctx.fillText('Elbow', elbowX - 25, elbowY + 25);
                    ctx.fillText('End Effector', endX - 45, endY + 25);

                } else if (activeTab === 'inverse') {
                    // Draw target point
                    ctx.fillStyle = '#e53e3e';
                    ctx.beginPath();
                    ctx.arc(targetX, targetY, 8, 0, 2 * Math.PI);
                    ctx.fill();

                    // Calculate inverse kinematics
                    const dx = targetX - originX;
                    const dy = originY - targetY;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    // Check if reachable
                    if (distance <= l1 + l2 && distance >= Math.abs(l1 - l2)) {
                        // Calculate angles using inverse kinematics
                        const cosTheta2 = (dx * dx + dy * dy - l1 * l1 - l2 * l2) / (2 * l1 * l2);
                        const theta2Calc = elbowConfig === 'up' ? 
                            Math.acos(Math.max(-1, Math.min(1, cosTheta2))) :
                            -Math.acos(Math.max(-1, Math.min(1, cosTheta2)));

                        const k1 = l1 + l2 * Math.cos(theta2Calc);
                        const k2 = l2 * Math.sin(theta2Calc);
                        const theta1Calc = Math.atan2(dy, dx) - Math.atan2(k2, k1);

                        // Calculate joint positions
                        const elbowX = originX + l1 * Math.cos(theta1Calc);
                        const elbowY = originY - l1 * Math.sin(theta1Calc);

                        const endX = elbowX + l2 * Math.cos(theta1Calc + theta2Calc);
                        const endY = elbowY - l2 * Math.sin(theta1Calc + theta2Calc);

                        // Draw reference line
                        ctx.strokeStyle = '#cbd5e0';
                        ctx.lineWidth = 2;
                        ctx.setLineDash([5, 5]);
                        ctx.beginPath();
                        ctx.moveTo(originX, originY);
                        ctx.lineTo(endX, endY);
                        ctx.stroke();
                        ctx.setLineDash([]);

                        // Draw links
                        ctx.strokeStyle = '#4299e1';
                        ctx.lineWidth = 8;
                        ctx.beginPath();
                        ctx.moveTo(originX, originY);
                        ctx.lineTo(elbowX, elbowY);
                        ctx.stroke();

                        ctx.strokeStyle = '#48bb78';
                        ctx.beginPath();
                        ctx.moveTo(elbowX, elbowY);
                        ctx.lineTo(endX, endY);
                        ctx.stroke();

                        // Draw joints
                        ctx.fillStyle = '#2d3748';
                        ctx.beginPath();
                        ctx.arc(originX, originY, 12, 0, 2 * Math.PI);
                        ctx.fill();

                        ctx.fillStyle = '#e53e3e';
                        ctx.beginPath();
                        ctx.arc(elbowX, elbowY, 10, 0, 2 * Math.PI);
                        ctx.fill();

                        // Draw workspace circle
                        ctx.strokeStyle = 'rgba(147, 197, 253, 0.3)';
                        ctx.lineWidth = 2;
                        ctx.setLineDash([5, 5]);
                        ctx.beginPath();
                        ctx.arc(originX, originY, l1 + l2, 0, 2 * Math.PI);
                        ctx.stroke();
                        ctx.setLineDash([]);

                        // Display calculated angles
                        ctx.fillStyle = '#2d3748';
                        ctx.font = 'bold 14px Arial';
                        ctx.fillText(`Œ∏‚ÇÅ = ${(theta1Calc * 180 / Math.PI).toFixed(1)}¬∞`, 20, 30);
                        ctx.fillText(`Œ∏‚ÇÇ = ${(theta2Calc * 180 / Math.PI).toFixed(1)}¬∞`, 20, 50);
                        ctx.fillText(`Distance = ${distance.toFixed(1)}px`, 20, 70);
                        ctx.fillText(`Config: ${elbowConfig === 'up' ? 'Elbow Up' : 'Elbow Down'}`, 20, 90);
                    } else {
                        ctx.fillStyle = '#e53e3e';
                        ctx.font = 'bold 18px Arial';
                        ctx.fillText('Target Out of Reach!', 20, 30);
                        ctx.fillText(`Distance: ${distance.toFixed(1)}px`, 20, 55);
                        ctx.fillText(`Max reach: ${(l1 + l2).toFixed(1)}px`, 20, 80);
                        ctx.fillText(`Min reach: ${Math.abs(l1 - l2).toFixed(1)}px`, 20, 105);
                    }

                    // Draw ground
                    ctx.strokeStyle = '#a0aec0';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(0, originY);
                    ctx.lineTo(width, originY);
                    ctx.stroke();
                }
            };

            const handleCanvasClick = (e) => {
                if (activeTab === 'inverse') {
                    const canvas = canvasRef.current;
                    const rect = canvas.getBoundingClientRect();
                    setTargetX(e.clientX - rect.left);
                    setTargetY(e.clientY - rect.top);
                }
            };

            const config = getElbowConfiguration(theta2);

            return (
                <div className="container">
                    <h1>ü§ñ Two-Link Robotic Arm Kinematics</h1>
                    <p className="subtitle">Interactive demonstration of forward and inverse kinematics</p>

                    <div className="tab-container">
                        <button 
                            className={`tab ${activeTab === 'parameters' ? 'active' : ''}`}
                            onClick={() => setActiveTab('parameters')}
                        >
                            Parameters
                        </button>
                        <button 
                            className={`tab ${activeTab === 'elbow' ? 'active' : ''}`}
                            onClick={() => setActiveTab('elbow')}
                        >
                            Elbow Configuration
                        </button>
                        <button 
                            className={`tab ${activeTab === 'inverse' ? 'active' : ''}`}
                            onClick={() => setActiveTab('inverse')}
                        >
                            Inverse Kinematics
                        </button>
                        <button 
                            className={`tab ${activeTab === 'flowchart' ? 'active' : ''}`}
                            onClick={() => setActiveTab('flowchart')}
                        >
                            Control Flow
                        </button>
                    </div>

                    <div className="content-section">
                        {activeTab === 'parameters' && (
                            <>
                                <div className="info-box">
                                    <h3>Parameter Definitions</h3>
                                    <p>A two-link robotic arm is defined by four key parameters that determine its configuration and reach:</p>
                                </div>

                                <div className="parameter-grid">
                                    <div className="parameter-card">
                                        <h4>l‚ÇÅ (Link 1)</h4>
                                        <p><strong>Length of the first link</strong></p>
                                        <p>Distance from shoulder to elbow joint</p>
                                        <p>Determines primary reach</p>
                                    </div>
                                    <div className="parameter-card">
                                        <h4>l‚ÇÇ (Link 2)</h4>
                                        <p><strong>Length of the second link</strong></p>
                                        <p>Distance from elbow to end effector</p>
                                        <p>Determines secondary reach</p>
                                    </div>
                                    <div className="parameter-card">
                                        <h4>Œ∏‚ÇÅ (Theta 1)</h4>
                                        <p><strong>Shoulder angle</strong></p>
                                        <p>Angle of first link relative to horizontal</p>
                                        <p>Measured counter-clockwise</p>
                                    </div>
                                    <div className="parameter-card">
                                        <h4>Œ∏‚ÇÇ (Theta 2)</h4>
                                        <p><strong>Elbow angle</strong></p>
                                        <p>Angle of second link relative to first link</p>
                                        <p>Relative joint angle</p>
                                    </div>
                                </div>

                                <div className="canvas-container">
                                    <canvas ref={canvasRef} width={800} height={500}></canvas>
                                </div>

                                <div className="controls">
                                    <div className="control-group">
                                        <label>Link 1 Length (l‚ÇÅ): <span className="value-display">{l1}px</span></label>
                                        <input 
                                            type="range" 
                                            min="50" 
                                            max="250" 
                                            value={l1} 
                                            onChange={(e) => setL1(Number(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Link 2 Length (l‚ÇÇ): <span className="value-display">{l2}px</span></label>
                                        <input 
                                            type="range" 
                                            min="50" 
                                            max="250" 
                                            value={l2} 
                                            onChange={(e) => setL2(Number(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Shoulder Angle (Œ∏‚ÇÅ): <span className="value-display">{theta1}¬∞</span></label>
                                        <input 
                                            type="range" 
                                            min="-180" 
                                            max="180" 
                                            value={theta1} 
                                            onChange={(e) => setTheta1(Number(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Elbow Angle (Œ∏‚ÇÇ): <span className="value-display">{theta2}¬∞</span></label>
                                        <input 
                                            type="range" 
                                            min="-180" 
                                            max="180" 
                                            value={theta2} 
                                            onChange={(e) => setTheta2(Number(e.target.value))}
                                        />
                                        <div className={`config-indicator config-${config}`}>
                                            {config === 'up' && 'üîº Elbow Up Configuration'}
                                            {config === 'down' && 'üîΩ Elbow Down Configuration'}
                                            {config === 'boundary' && '‚ö†Ô∏è Singularity (Œ∏‚ÇÇ = ¬±90¬∞)'}
                                        </div>
                                    </div>
                                </div>

                                <div className="info-box">
                                    <h3>Forward Kinematics Equations</h3>
                                    <p>Given the angles Œ∏‚ÇÅ and Œ∏‚ÇÇ, we can calculate the end effector position (x, y):</p>
                                    <div className="equation">
                                        x = l‚ÇÅ¬∑cos(Œ∏‚ÇÅ) + l‚ÇÇ¬∑cos(Œ∏‚ÇÅ + Œ∏‚ÇÇ)
                                    </div>
                                    <div className="equation">
                                        y = l‚ÇÅ¬∑sin(Œ∏‚ÇÅ) + l‚ÇÇ¬∑sin(Œ∏‚ÇÅ + Œ∏‚ÇÇ)
                                    </div>
                                </div>
                            </>
                        )}

                        {activeTab === 'elbow' && (
                            <>
                                <div className="info-box warning">
                                    <h3>‚ö†Ô∏è Elbow Configuration: Up vs Down</h3>
                                    <p>For most target positions within reach, there are <strong>two possible solutions</strong> to reach the same point.</p>
                                    <p style={{marginTop: '10px', fontWeight: 'bold'}}>IMPORTANT: The elbow configuration is determined by the MAGNITUDE of Œ∏‚ÇÇ, not just its sign!</p>
                                </div>

                                <div className="elbow-demo">
                                    <div className="elbow-card">
                                        <h3>üîº Elbow Up Configuration</h3>
                                        <ul style={{textAlign: 'left', color: '#4a5568'}}>
                                            <li><strong>Definition: |Œ∏‚ÇÇ| &lt; 90¬∞</strong></li>
                                            <li>The arm is relatively extended</li>
                                            <li>Elbow bends less than 90 degrees</li>
                                            <li>Range: -90¬∞ &lt; Œ∏‚ÇÇ &lt; 90¬∞</li>
                                            <li>Examples:
                                                <ul>
                                                    <li>Œ∏‚ÇÇ = 45¬∞ ‚úì (elbow up)</li>
                                                    <li>Œ∏‚ÇÇ = -60¬∞ ‚úì (elbow up)</li>
                                                    <li>Œ∏‚ÇÇ = 0¬∞ ‚úì (fully extended)</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </div>
                                    <div className="elbow-card">
                                        <h3>üîΩ Elbow Down Configuration</h3>
                                        <ul style={{textAlign: 'left', color: '#4a5568'}}>
                                            <li><strong>Definition: |Œ∏‚ÇÇ| &gt; 90¬∞</strong></li>
                                            <li>The arm is more folded/bent</li>
                                            <li>Elbow bends more than 90 degrees</li>
                                            <li>Range: 90¬∞ &lt; |Œ∏‚ÇÇ| ‚â§ 180¬∞</li>
                                            <li>Examples:
                                                <ul>
                                                    <li>Œ∏‚ÇÇ = 135¬∞ ‚úì (elbow down)</li>
                                                    <li>Œ∏‚ÇÇ = -120¬∞ ‚úì (elbow down)</li>
                                                    <li>Œ∏‚ÇÇ = ¬±180¬∞ ‚úì (fully folded)</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </div>
                                </div>

                                <div className="canvas-container">
                                    <canvas ref={canvasRef} width={800} height={500}></canvas>
                                </div>

                                <div className="controls">
                                    <div className="control-group">
                                        <label>Link 1 Length (l‚ÇÅ): <span className="value-display">{l1}px</span></label>
                                        <input 
                                            type="range" 
                                            min="50" 
                                            max="250" 
                                            value={l1} 
                                            onChange={(e) => setL1(Number(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Link 2 Length (l‚ÇÇ): <span className="value-display">{l2}px</span></label>
                                        <input 
                                            type="range" 
                                            min="50" 
                                            max="250" 
                                            value={l2} 
                                            onChange={(e) => setL2(Number(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Shoulder Angle (Œ∏‚ÇÅ): <span className="value-display">{theta1}¬∞</span></label>
                                        <input 
                                            type="range" 
                                            min="-180" 
                                            max="180" 
                                            value={theta1} 
                                            onChange={(e) => setTheta1(Number(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Elbow Angle (Œ∏‚ÇÇ): <span className="value-display">{theta2}¬∞</span></label>
                                        <input 
                                            type="range" 
                                            min="-180" 
                                            max="180" 
                                            value={theta2} 
                                            onChange={(e) => setTheta2(Number(e.target.value))}
                                        />
                                        <div className={`config-indicator config-${config}`}>
                                            {config === 'up' && `üîº Elbow Up (|Œ∏‚ÇÇ| = ${Math.abs(theta2)}¬∞ < 90¬∞)`}
                                            {config === 'down' && `üîΩ Elbow Down (|Œ∏‚ÇÇ| = ${Math.abs(theta2)}¬∞ > 90¬∞)`}
                                            {config === 'boundary' && '‚ö†Ô∏è Singularity: Œ∏‚ÇÇ = ¬±90¬∞'}
                                        </div>
                                    </div>
                                </div>

                                <div className="info-box">
                                    <h3>üéØ Critical Angles (Singularities)</h3>
                                    <ul style={{color: '#4a5568'}}>
                                        <li><strong>Œ∏‚ÇÇ = 0¬∞:</strong> Both links perfectly aligned, arm fully extended</li>
                                        <li><strong>Œ∏‚ÇÇ = ¬±90¬∞:</strong> Links are perpendicular - BOUNDARY between elbow up and down</li>
                                        <li><strong>Œ∏‚ÇÇ = ¬±180¬∞:</strong> Both links aligned in opposite directions, arm fully folded</li>
                                    </ul>
                                </div>

                                <div className="info-box">
                                    <h3>Behavior in two_joint_arm_to_point_control.py</h3>
                                    <p><strong>When the Python script runs with inverse kinematics:</strong></p>
                                    <ul style={{color: '#4a5568'}}>
                                        <li><strong>Elbow Up Mode (|Œ∏‚ÇÇ| &lt; 90¬∞):</strong> 
                                            <ul>
                                                <li>Uses positive square root: Œ∏‚ÇÇ = +arccos(...)</li>
                                                <li>Arm takes the more extended path to target</li>
                                                <li>Better for reaching over obstacles</li>
                                                <li>More natural for human-like overhead motions</li>
                                            </ul>
                                        </li>
                                        <li><strong>Elbow Down Mode (|Œ∏‚ÇÇ| &gt; 90¬∞):</strong> 
                                            <ul>
                                                <li>Uses negative square root: Œ∏‚ÇÇ = -arccos(...)</li>
                                                <li>Arm takes the more folded path to target</li>
                                                <li>Better for reaching under obstacles</li>
                                                <li>More compact configuration</li>
                                            </ul>
                                        </li>
                                        <li><strong>Configuration Switching:</strong> 
                                            <ul>
                                                <li>Switching between up and down for same target requires passing through singularity</li>
                                                <li>May cause discontinuous motion if not planned carefully</li>
                                            </ul>
                                        </li>
                                        <li><strong>At Singularities (Œ∏‚ÇÇ = ¬±90¬∞):</strong>
                                            <ul>
                                                <li>Configuration is ambiguous</li>
                                                <li>Control algorithms must handle carefully to avoid instability</li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </>
                        )}

                        {activeTab === 'inverse' && (
                            <>
                                <div className="info-box">
                                    <h3>Inverse Kinematics: Point to Point Control</h3>
                                    <p>Click anywhere on the canvas to set a target position. The arm will calculate the required joint angles (Œ∏‚ÇÅ and Œ∏‚ÇÇ) to reach that point.</p>
                                    <p style={{marginTop: '10px'}}>The dashed line shows the direct path from shoulder to end effector. Try switching between elbow up and down to see both solutions!</p>
                                </div>

                                <div className="controls">
                                    <div className="control-group">
                                        <label>Link 1 Length (l‚ÇÅ): <span className="value-display">{l1}px</span></label>
                                        <input 
                                            type="range" 
                                            min="50" 
                                            max="250" 
                                            value={l1} 
                                            onChange={(e) => setL1(Number(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Link 2 Length (l‚ÇÇ): <span className="value-display">{l2}px</span></label>
                                        <input 
                                            type="range" 
                                            min="50" 
                                            max="250" 
                                            value={l2} 
                                            onChange={(e) => setL2(Number(e.target.value))}
                                        />
                                    </div>
                                    <div className="control-group">
                                        <label>Elbow Configuration:</label>
                                        <div style={{display: 'flex', gap: '10px', marginTop: '10px'}}>
                                            <button 
                                                onClick={() => setElbowConfig('up')}
                                                style={{
                                                    flex: 1,
                                                    background: elbowConfig === 'up' ? 
                                                        'linear-gradient(135deg, #48bb78 0%, #38a169 100%)' : '#e2e8f0',
                                                    color: elbowConfig === 'up' ? 'white' : '#4a5568'
                                                }}
                                            >
                                                üîº Elbow Up<br/>(|Œ∏‚ÇÇ| &lt; 90¬∞)
                                            </button>
                                            <button 
                                                onClick={() => setElbowConfig('down')}
                                                style={{
                                                    flex: 1,
                                                    background: elbowConfig === 'down' ? 
                                                        'linear-gradient(135deg, #f56565 0%, #c53030 100%)' : '#e2e8f0',
                                                    color: elbowConfig === 'down' ? 'white' : '#4a5568'
                                                }}
                                            >
                                                üîΩ Elbow Down<br/>(|Œ∏‚ÇÇ| &gt; 90¬∞)
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div className="canvas-container">
                                    <canvas 
                                        ref={canvasRef} 
                                        width={800} 
                                        height={500}
                                        onClick={handleCanvasClick}
                                        style={{cursor: 'crosshair'}}
                                    ></canvas>
                                </div>

                                <div className="info-box">
                                    <h3>Inverse Kinematics Equations</h3>
                                    <p>Given a target position (x, y), we calculate the angles using:</p>
                                    <div className="equation">
                                        d¬≤ = x¬≤ + y¬≤
                                    </div>
                                    <div className="equation">
                                        cos(Œ∏‚ÇÇ) = (d¬≤ - l‚ÇÅ¬≤ - l‚ÇÇ¬≤) / (2¬∑l‚ÇÅ¬∑l‚ÇÇ)
                                    </div>
                                    <div className="equation">
                                        Œ∏‚ÇÇ = ¬±arccos(cos(Œ∏‚ÇÇ))   [+ for elbow up, - for elbow down]
                                    </div>
                                    <div className="equation">
                                        Œ∏‚ÇÅ = atan2(y, x) - atan2(l‚ÇÇ¬∑sin(Œ∏‚ÇÇ), l‚ÇÅ + l‚ÇÇ¬∑cos(Œ∏‚ÇÇ))
                                    </div>
                                    <p style={{marginTop: '15px'}}><strong>Workspace:</strong> The arm can reach any point within a circle of radius (l‚ÇÅ + l‚ÇÇ) but outside a circle of radius |l‚ÇÅ - l‚ÇÇ|.</p>
                                </div>
                            </>
                        )}

                        {activeTab === 'flowchart' && (
                            <>
                                <div className="info-box">
                                    <h3>Control Flow: Moving from Point A to Point B</h3>
                                    <p>This flowchart describes the algorithm for calculating angle changes needed to move the end effector from one position to another using changes in x and y (Œîx, Œîy).</p>
                                </div>

                                <div className="flowchart">
                                    <div className="flow-node">
                                        START: Current position (x‚ÇÅ, y‚ÇÅ) with angles Œ∏‚ÇÅ and Œ∏‚ÇÇ
                                    </div>
                                    <div className="flow-arrow">‚Üì</div>
                                    
                                    <div className="flow-node">
                                        INPUT: Desired displacement Œîx and Œîy
                                    </div>
                                    <div className="flow-arrow">‚Üì</div>
                                    
                                    <div className="flow-node">
                                        CALCULATE: Target position<br/>
                                        x‚ÇÇ = x‚ÇÅ + Œîx<br/>
                                        y‚ÇÇ = y‚ÇÅ + Œîy
                                    </div>
                                    <div className="flow-arrow">‚Üì</div>
                                    
                                    <div className="flow-node">
                                        CALCULATE: Distance to target<br/>
                                        d = ‚àö(x‚ÇÇ¬≤ + y‚ÇÇ¬≤)
                                    </div>
                                    <div className="flow-arrow">‚Üì</div>
                                    
                                    <div className="flow-node" style={{background: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)'}}>
                                        DECISION: Is target reachable?<br/>
                                        |l‚ÇÅ - l‚ÇÇ| ‚â§ d ‚â§ l‚ÇÅ + l‚ÇÇ
                                    </div>
                                    <div className="flow-arrow">‚Üì YES</div>
                                    
                                    <div className="flow-node">
                                        CALCULATE: New Œ∏‚ÇÇ using inverse kinematics<br/>
                                        cos(Œ∏‚ÇÇ_new) = (d¬≤ - l‚ÇÅ¬≤ - l‚ÇÇ¬≤) / (2¬∑l‚ÇÅ¬∑l‚ÇÇ)<br/>
                                        Œ∏‚ÇÇ_new = ¬±arccos(...) [maintain elbow config]
                                    </div>
                                    <div className="flow-arrow">‚Üì</div>
                                    
                                    <div className="flow-node">
                                        CALCULATE: New Œ∏‚ÇÅ<br/>
                                        k‚ÇÅ = l‚ÇÅ + l‚ÇÇ¬∑cos(Œ∏‚ÇÇ_new)<br/>
                                        k‚ÇÇ = l‚ÇÇ¬∑sin(Œ∏‚ÇÇ_new)<br/>
                                        Œ∏‚ÇÅ_new = atan2(y‚ÇÇ, x‚ÇÇ) - atan2(k‚ÇÇ, k‚ÇÅ)
                                    </div>
                                    <div className="flow-arrow">‚Üì</div>
                                    
                                    <div className="flow-node">
                                        CALCULATE: Angle changes<br/>
                                        ŒîŒ∏‚ÇÅ = Œ∏‚ÇÅ_new - Œ∏‚ÇÅ<br/>
                                        ŒîŒ∏‚ÇÇ = Œ∏‚ÇÇ_new - Œ∏‚ÇÇ
                                    </div>
                                    <div className="flow-arrow">‚Üì</div>
                                    
                                    <div className="flow-node">
                                        EXECUTE: Send commands to motors<br/>
                                        Motor1.rotate(ŒîŒ∏‚ÇÅ)<br/>
                                        Motor2.rotate(ŒîŒ∏‚ÇÇ)
                                    </div>
                                    <div className="flow-arrow">‚Üì</div>
                                    
                                    <div className="flow-node">
                                        UPDATE: Current angles<br/>
                                        Œ∏‚ÇÅ ‚Üê Œ∏‚ÇÅ_new<br/>
                                        Œ∏‚ÇÇ ‚Üê Œ∏‚ÇÇ_new
                                    </div>
                                    <div className="flow-arrow">‚Üì</div>
                                    
                                    <div className="flow-node" style={{background: 'linear-gradient(135deg, #48bb78 0%, #38a169 100%)'}}>
                                        END: Arm at new position (x‚ÇÇ, y‚ÇÇ)
                                    </div>
                                </div>

                                <div className="info-box">
                                    <h3>Key Points</h3>
                                    <ul style={{color: '#4a5568'}}>
                                        <li><strong>Œîx and Œîy:</strong> Represent the desired change in end effector position in Cartesian coordinates</li>
                                        <li><strong>Reachability Check:</strong> Essential to verify the target is within the workspace before calculating angles</li>
                                        <li><strong>Elbow Configuration:</strong> Must be maintained (up or down) by choosing the appropriate sign for Œ∏‚ÇÇ</li>
                                        <li><strong>Singularities:</strong> Special handling needed when arm is fully extended (Œ∏‚ÇÇ = 0¬∞) or at ¬±90¬∞ boundary</li>
                                        <li><strong>Trajectory Planning:</strong> For smooth motion, intermediate points can be calculated and the process repeated in a loop</li>
                                        <li><strong>Error Handling:</strong> If target is unreachable, either reject motion or move to closest reachable point</li>
                                    </ul>
                                </div>
                            </>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<TwoLinkArmDemo />);
    </script>
</body>
</html>
